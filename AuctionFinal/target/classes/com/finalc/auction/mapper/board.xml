<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 

<!-- 게시판 xml -->

<!-- ==== 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="board">

<!-- 검색어가 없는 총게시물 건수 07.03 시작 -->
	<select id="getTotalCount" resultType="Integer">
		select count(*)
		from tbl_board
		where boardstatus = 1
	</select>
<!-- 검색어가 없는 총게시물 건수 07.03 끝-->

<!-- 검색어가 있는 총게시물 건수 07.03 시작 -->
	<select id="getTotalCount2" parameterType="HashMap" resultType="Integer">
		select count(*)
		from tbl_board
		where boardstatus = 1
		and ${colname} like '%'|| #{search} ||'%'
	</select>
<!-- 검색어가 있는 총게시물 건수 07.03 끝-->

	<select id="boardList" parameterType="HashMap" resultType="com.finalc.auction.model.BoardVO">
	select boardno, fk_userid, subject, viewcount, writeday, commentcount
	from 
	(
	select rownum as RNO
	     , V.boardno, V.fk_userid, V.subject, V.content, V.viewcount, V.writeday, V.commentcount
	from 
	(
	select boardno, fk_userid 
	     , case when length(subject) > 20 then substr(subject, 1, 18)||'..'
	            else subject end as subject
	     , content , viewcount
	     , to_char(writeday, 'yyyy-mm-dd hh24:mi:ss') as writeday
	     , commentcount
	from tbl_board
	where boardstatus = 1
	order by boardno desc
	) V
	) T
	where T.RNO >= #{startRno} and T.RNO <![CDATA[<=]]> #{endRno} 
	</select>




</mapper>